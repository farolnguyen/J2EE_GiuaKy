<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security" lang="en">
<head>
    <meta charset="UTF-8">
    <title>Debug Authentication</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .info { background: #e7f3ff; padding: 15px; margin: 10px 0; border-radius: 5px; }
        .success { background: #d4edda; color: #155724; }
        .warning { background: #fff3cd; color: #856404; }
        .error { background: #f8d7da; color: #721c24; }
        pre { background: #f5f5f5; padding: 10px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>Debug Authentication Page</h1>
    
    <div class="info">
        <h3>Thymeleaf Security Check</h3>
        
        <p><strong>isAuthenticated():</strong> 
            <span sec:authorize="isAuthenticated()" class="success">YES - Authenticated</span>
            <span sec:authorize="!isAuthenticated()" class="error">NO - Not Authenticated</span>
        </p>
        
        <p><strong>hasAuthority('USER'):</strong>
            <span sec:authorize="hasAuthority('USER')" class="success">YES - Has USER</span>
            <span sec:authorize="!hasAuthority('USER')" class="warning">NO - Missing USER</span>
        </p>
        
        <p><strong>hasAuthority('ADMIN'):</strong>
            <span sec:authorize="hasAuthority('ADMIN')" class="success">YES - Has ADMIN</span>
            <span sec:authorize="!hasAuthority('ADMIN')" class="warning">NO - Missing ADMIN</span>
        </p>
        
        <p><strong>hasAnyAuthority('ADMIN','USER'):</strong>
            <span sec:authorize="hasAnyAuthority('ADMIN','USER')" class="success">YES - Has ADMIN or USER</span>
            <span sec:authorize="!hasAnyAuthority('ADMIN','USER')" class="error">NO - Missing both</span>
        </p>
        
        <p><strong>Principal Name:</strong>
            <span sec:authentication="name">Not Available</span>
        </p>
        
        <p><strong>Authorities:</strong>
            <span sec:authentication="authorities">Not Available</span>
        </p>
    </div>
    
    <div class="info">
        <h3>Test Links</h3>
        <ul>
            <li><a href="/cart">Cart (requires USER/ADMIN)</a></li>
            <li><a href="/wishlist">Wishlist (requires USER/ADMIN)</a></li>
            <li><a href="/profile">Profile (requires USER/ADMIN)</a></li>
            <li><a href="/orders">Orders (requires USER/ADMIN)</a></li>
            <li><a href="/api/debug/auth">API Debug (JSON)</a></li>
        </ul>
    </div>
    
    <div class="info">
        <h3>Session Info</h3>
        <p><strong>Session ID:</strong> <span th:text="${sessionId}">Unknown</span></p>
    </div>
</body>
</html>
